# Design and Implementation of a Flight Controller for a Quadrotor

# Unmanned Aerial Vehicle

## Madhav Sawant, Shrawani Joshi, Faisal Kapdi, Harshada Pawar, Prof. Amol Sutar

## Department of Electronics & Telecommunication Engineering, Finolex Academy of

## Management and Technology, Ratnagiri, India

## Abstract:

```
Unmanned Aerial Vehicles (UAVs) require reliable, flexible and efficient flight controllers to achieve
stable and precise operation, in which existing system are closed source with complex codes, while
cost effectiveness remains an important consideration for scalable and educational Platforms. This
paper presents the design and implementation of an open-source, low-cost flight controller for a
quadrotor UAV based on the (Espressif32) ESP32 microcontroller. The proposed system integrates
onboard processing, wireless connectivity, and multi-sensor support on a custom-designed Printed
Circuit Board (PCB), which can be made suitable for both educational and experimental applications.
The flight controller incorporates an Inertial Measurement Unit (IMU), global positioning module,
barometric sensor, and wireless telemetry to enable real-time state estimation, navigation, and
monitoring. A dual loop Proportional–Integral–Derivative (PID) control method is implemented for
roll, pitch and yaw stabilization, while a Complementary filter is employed to fuse gyroscope and
accelerometer data, reducing noise and drift in attitude estimation. Experimental results demonstrate
stable hover performance and responsive pilot control under real-time operating conditions. The Result
shows stable hover, Damping factor (ζ)=0.71 and Phase Margin (PM)=81° The proposed system offers
transparency through open-source implementation, reduced component cost, and enhanced
connectivity through integrated Wi-Fi that can help to bridge theoretical concepts with practical
implementation and scalable foundation for future enhancements such as autonomous navigation,
adaptive control and intelligent flight optimization thereby contributing to accessible and flexible
UAV development.
```
## Keywords — Quadrotor UAV, Flight Controller Design, ESP32 Microcontroller, PID Control,

```
Complementary filter
```
## I. INTRODUCTION

Recent Advancements in field of UAVs have led to increase in demand of the efficient flight controller.
However, existing solutions face challenges such as High Cost, Open Source, Proprietary Ecosystem
Overkill for simple applications, etc. The existing flight controllers are closed source and have high cost
to procure for educational purpose. Moreover, the open-source platforms come with complex codebase.
To address these issues, this paper presents a Cost Effective, Open Source, Open Hardware Architecture
with flexible integration. The proposed approach aims designing and implementing a custom flight
controller board with integrated sensors and firmware, adaptable for various UAV applications which
can serve as an educational open platform for students learning UAV control systems. Its architecture
and transparent implementation can make it suitable for academic use, allowing students to understand
and experiment with flight control algorithms and sensor integration. Flight Controller acts as the
drone’s brain processing pilot inputs and sensor data for stable and precise flight. To solve the problem
the project is develop with ESP32-based system that provides integrated (Wireless Fidelity) Wi-Fi,


sufficient storage, and multiple serial ports in a single, affordable unit and is implemented on a custom
designed PCB. To enable reliable navigation and state estimation, the system integrates multiple sensors,
including a Motion Processing Unit (MPU6050), a Global Positioning System (GPS) module,
barometer, etc. This hardware configuration provides a compact and cost-effective platform suitable for
UAV control and experimentation. The design phase involves defining the system architecture, selecting
appropriate hardware and software components, and developing the logical flow and control strategy of
the system. It ensures that the overall structure of the system meets functional and performance
requirements before actual development. The implementation phase involves the practical prototype and
PCB circuit of the designed system. This includes hardware assembly and interfacing, software
development, integration of various modules, and testing of the system under real-time conditions. The
results obtained from the implementation demonstrate that the proposed system operates reliably and
meets the intended objectives.

## II. LITERATURE REVIEW

The research demonstrated that a cascade PID controller combined with sensor filtering provides stable
and effective flight control for quadrotor UAVs. Previous work explored advanced control strategies to
improve altitude response while emphasizing low-complexity and low-power flight controller
implementations suitable for embedded systems. The present work adopts a dual-loop cascade PID
control structure with inner and outer loops for roll, pitch, and yaw, enabling stable flight performance.
Some researchers further suggested the application of Model Predictive Control (MPC) for enhanced
trajectory tracking and stabilization in quadrotor UAVs. In addition, research on navigation accuracy
emphasized minimizing IMU sensor noise, bias, and drift using Kalman filtering and Zero Velocity
Compensation (ZVC) techniques. The Kalman Filter was shown to effectively reduce sensor drift,
achieving approximately 95% angular accuracy and 90% translational accuracy. Building on this, the
present work applies a simplified one- dimensional Kalman filter on the roll and pitch axes to fuse
gyroscope and accelerometer data, providing drift-resistant angle estimation and improving both short-
term and long-term attitude stability. Further studies proposed real-time embedded implementation to
enhance navigation accuracy and computational efficiency [1]-[4]. Several studies focused on stabilizing
and controlling quadrotor attitude using an optimized PID controller and compared its performance with
alternative nonlinear control methods such as the back-stepping controller. These studies highlighted the
fundamental instability of quadrotor attitude dynamics and the necessity of robust feedback control
mechanisms. Results showed that an optimized PID controller offers faster response, improved stability,
and better disturbance rejection compared to the back-stepping controller [5]. Moreover, sensor fusion
approaches using complementary filters were shown to provide reliable attitude estimation, significantly
improving PID-based stabilization performance in quadrotor systems [6]. Recent studies have
highlighted the growing use of UAVs in applications such as precision agriculture, infrastructure
inspection, and environmental monitoring due to their efficiency and data collection capabilities.
Research on real-time UAV control emphasized low-latency communication and robust control
architectures for stable flight performance. Multi-UAV ground control stations were shown to enable
effective coordination and mission management in complex environments [7]-[9]. Studies on embedded
real-time operating systems revealed that Real Time Operating System (RTOS) selection strongly
influences performance and energy consumption in UAV flight controllers [10]. Fault-tolerant and
optimization-based control approaches, including multi-rate control and Particle Swarm Optimization
(PSO) tuned PID controllers, demonstrated improved stability, robustness, and response under
disturbances and actuator faults [11], [12]. In addition, actuator fault detection using inertial sensors
enhanced UAV safety, while hardware selection surveys provided essential guidelines for designing
efficient and reliable UAV platforms [13], [14]. Sensor fusion is justified because gyroscope-only
attitude estimation suffers from cumulative drift over time, while accelerometer-only estimation is


highly sensitive to noise and vibration during operation. By combining both sensors, sensor fusion
exploits the short-term stability of the gyroscope and the long-term reference of the accelerometer to
achieve accurate and reliable attitude estimation for sustained flight. Experimental evaluation showed
that both the 1D Kalman filter and the Complementary filter achieved comparable attitude estimation
accuracy, maintaining stability within ±0.5° while effectively mitigating gyroscope drift and
accelerometer noise. Given this equivalent performance, the Complementary filter was selected due to
its significantly lower computational complexity, simpler tuning, smaller memory footprint, and better
suitability for reliable real-time implementation on resource-constrained flight controllers [15].

## III. METHODOLOGY

## A. System Design (Hardware)

1. Overall System Architecture

The proposed quadrotor flight controller follows a modular, layered system architecture that separates
sensing, control, actuation, and communication functions to ensure deterministic real-time performance
and system reliability. At the lowest level, onboard sensors including an MPU6050, barometric pressure
sensor, and GPS module continuously acquire raw motion, altitude, and positional data. These sensor
signals are interfaced directly to the ESP32 microcontroller through Inter-Integrated Circuit (I²C) and
Universal Asynchronous Receiver Transmitter (UART) communication buses. Within the ESP32,
sensor data first undergoes preprocessing and filtering. A complementary filter fuses gyroscope and
accelerometer measurements to obtain drift-reduced roll and pitch estimates, while raw gyroscope data
supports yaw rate estimation. The filtered attitude information is then passed to a dual-loop PID control
structure, where the outer loop regulates angular position and the inner loop controls angular rates. This
control computation is executed on a dedicated processor core to guarantee consistent loop timing. The
PID controller outputs are translated into high-resolution Pulse Width Modulation (PWM) signals using
the ESP32’s dedicated Motor Control PWM (MCPWM) peripheral. These signals are fed to four
Electronic Speed Controllers (ESCs), which in turn regulate the speeds of the brushless DC motors,
producing the required thrust and torque for quadrotor stabilization and maneuvering. Parallel to the
flight-critical control path, a telemetry and diagnostics subsystem operate independently. Flight states,
sensor readings, and control outputs are transmitted via the Nordic Radio Frequency (nRF24L01)
wireless module to a ground station for real-time monitoring. Additionally, a non-blocking data logging
mechanism queues control and sensor data to a secondary core, where it is stored in a circular RAM
buffer for post-flight analysis. This architectural separation ensures that telemetry, logging, and
communication tasks do not interfere with the real-time stability of the flight control loop.

2. Microcontroller Selection

The microcontroller was selected through a comparative analysis of three prevalent platforms the
Arduino ecosystem, the STM32 family including the F103 Blue Pill and F411 Black Pill, and the ESP32.
The selection criteria prioritized achieving stable flight control while simultaneously managing
telemetry transmission without system interruptions. Based on the hardware specifications and
architectural features, the ESP32 was identified as the optimal choice that balanced performance
requirements with the budget constraints of this project.

2.1 Single-Core Architecture Considerations


The STM32F103 Blue Pill and STM32F411 Black Pill were examined. These industry-standard
microcontrollers share a common architectural characteristic that is single-core processing. In drone
control systems, the processor must execute two critical concurrent tasks maintaining aircraft stability
through standard PID control loops and managing real-time telemetry. Single-core architectures require
rapid context switching between these tasks, which can introduce timing inconsistencies in motor control
when the processor services communication routines. The ESP32 was selected specifically to address
this architectural limitation. Its dual-core design enables physical workload separation Core 0 is
dedicated to flight control operations, while Core 1 manages data communication. This configuration
ensures that the flight control loop executes without interruption from telemetry processes. Existing
flight controllers such as Pixhawk, which utilize STM32 processors, employ sophisticated time-slicing
algorithms and highly optimized code to achieve effective multitasking. However, single-core systems
may experience timing inconsistencies when tasks compete for processor time. The ESP32’s dual-core
architecture helps mitigate this by enabling physical task separation, reducing the likelihood that a
malfunction in one subsystem affects the other. The ESP32's true parallel processing architecture
provides an inherent advantage by physically isolating tasks across separate cores; the system achieves
greater fault tolerance. A malfunction in the telemetry subsystem would not compromise the flight
control subsystem, thereby enhancing overall system reliability for research applications.

2.2 Memory Requirements Analysis

Memory capacity constituted a critical constraint in the design process. The Arduino Uno, with 2 KB of
RAM, was deemed insufficient for implementing precise floating-point PID control. Similarly, the
STM32 Blue Pill's 20 KB RAM presented significant limitations for safe operation. Although most
Existing UAV flight controllers are based on STM32 microcontrollers due to their deterministic real-
time performance, the ESP32 was selected in this work for its integrated wireless connectivity and larger
on-chip memory. With 520 KB of RAM, the ESP32 provides greater computational headroom, enabling
the simultaneous operation of a real-time operating system and telemetry tasks with adequate safety
margins, thereby reducing the risk of memory exhaustion during flight operations.

2.3 Hardware Integration Efficiency

Minimizing hardware complexity was an additional design objective. STM32-based solutions require
external modules for wireless communication, which increases wiring complexity and system weight.
The ESP32 integrates Wi-Fi and Bluetooth capabilities natively. While the current prototype employs a
dedicated long-range radio module nRF24L01, the onboard Wi-Fi provides a secondary communication
channel and positions future iterations of this research platform to support advanced features without
requiring additional hardware modifications.

2.4 Specialized Peripheral Capabilities

An evaluation of the proposed system was conducted for the hardware's ability to generate stable control
signals for the ESCs. In standard low-cost architectures like the ATmega328P Arduino, PWM signals
are often generated using general-purpose timers. At the high frequencies required for drone stability,
these timers consume significant Central Processing Unit (CPU) resources and can suffer from slight
timing variations known as signal jitter. The ESP32 features a dedicated MCPWM hardware unit. This
peripheral is designed specifically for power electronics and motor control. It generates high-resolution,
jitter-free signals completely independently of the main CPU. By offloading the motor signal generation
to this dedicated hardware, we ensure that the motors receive smooth, precise commands even if the
main processor is handling other tasks. This hardware feature is typically found only in industrial-grade
microcontrollers, making the ESP32 well-suited for this application.


2.5 GPS Integration

While the current control architecture focuses on manual pilot operation, a Global Navigation Satellite
System (GNSS) receiver was integrated to provide real-time state estimation and velocity data for live
telemetry transmission.

3. Sensor Selection

3.1 Cost - Precision Analysis

The Analysis of proposed system was evaluated for two common modules for this application the u-
blox NEO-M8N the Standard Precision and the u-blox NEO-6M the Budget Variant. For the primary
research prototype, we selected the M8N. Although it comes at a higher hardware cost compared to the
6M, it supports concurrent reception of multiple satellite constellations like GPS, Galileo, etc. In our
field tests, this allowed the system to acquire a 3D Lock significantly faster and maintain signal integrity
in environments with partial obstructions. However, to ensure the project remains accessible to students
with strictly limited budgets, the firmware drivers are designed to be fully backward-compatible with
the NEO-6M. This allows future replications of this project to utilize the lower-cost module for basic
telemetry if the higher precision and multi-constellation support of the M8N are not required.

3.2 Role in Manual Flight

In the current manual control configuration, the GPS does not directly influence the PID loop. Instead,
it serves as a critical Telemetry Sensor. It transmits the drone's coordinates, altitude, and ground speed
to the ground station in real-time. This provides the pilot with essential situational awareness during
flight operations, verifying the drone's velocity and location live on the ground control screen.

4. Communication Architecture

4.1 Wireless Communication Architecture

To ensure maximum safety and data reliability, the system implements a Dual-Link Communication
Architecture. Instead of utilizing a single radio channel for both pilot input and data feedback, we
separated the Critical Control Path from the Telemetry Path. This separation ensures that even if the
experimental telemetry link fails, the pilot retains full control over the aircraft’s orientation and throttle.

5. Black Box

In UAV systems, flight dynamics evolve at time scales that are far beyond human perception. During
flight, many critical control events occur within milliseconds and cannot be reliably diagnosed through
visual observation alone. To solve this issue and help tune PID better, a custom black box system similar
to that used in airplanes is implemented, which helps in post-flight analysis. This system records in-
flight data that captures time-synchronized sensor measurements, attitude estimates, pilot input, PID
controller outputs, actuator commands, and system health, which enables objective diagnosis of control
behavior and failure modes, rather than just guessing based on actual flight observation. A key challenge
is addressed during the implementation, which is the non-deterministic latency of flash memory write
operations, typically 10–20 ms, which is incompatible with real-time control operation. To eliminate
this, the dual-core system architecture of the ESP32 is used. Here, the primary control core serializes


the full system state into a high-speed RAM buffer within the flight control loop, ensuring zero impact
on the 250 Hz stability loop, while a low-priority background task running on the auxiliary core
asynchronously commits the buffered data to non-volatile storage using the fail-safe LittleFS file system.
Upon mission completion, the system transitions to a ground mode, in which an embedded HTTP server
reveals the stored dataset via a RESTful interface, allowing wireless log extraction for time-domain
analysis of sensor noise, mechanical phase lag, and control loop performance without requiring physical
data access. The block diagram shows the proposed onboard black box data-logging architecture
implemented on a dual-core ESP32, designed to preserve real-time flight stability while enabling high-
resolution post-flight analysis. The system utilizes functional separation between the two processor
cores, where Core 1 is reserved exclusively for flight-controller operations and Core 0 handles non-real-
time system services. On Core 1, inertial measurements from the IMU are processed through a sensor-
fusion algorithm to estimate UAV attitude, which is then used by the PID controller to compute actuator
commands for the motors. To avoid latency issues, the system is designed such that no direct memory
or I/O operations are performed within the control loop; instead, the complete control state—including
sensor data, attitude estimates, PID terms, and motor outputs—is compressed into a compact data
structure and pushed into a Free RTOS queue using a non-blocking operation. This queue acts as a fast
handoff mechanism between the two cores.

```
Figure 1: System architecture and data flow of the black box logging and analysis framework
```
On Core 0, a low-priority logger task continuously waits for queued packets and writes them into a
fixed-size circular ring buffer allocated in RAM. The buffer operates using overwrite logic such that,
once its capacity is reached, older samples are automatically replaced, maintaining a rolling window of
the most recent flight history. After landing, the system transitions into a ground-mode state in which an
embedded web server provides controlled read access to the RAM buffer; logging is momentarily
paused, the binary data is serialized into CSV format, and the dataset is transmitted wirelessly to an
external device connected to the ESP32 Wi-Fi interface for analysis. Since the black box relies solely
on volatile memory, all stored data is inherently transient and is discarded upon power removal, ensuring
minimal write latency, deterministic control timing, and complete isolation between flight-critical and
diagnostic subsystems.


6. PCB Design

```
Figure 2: Circuit schematic
```
## B. Control System Design

7. System Block Diagram

The given block diagram shows the flight controller system of a drone. The main part of the system is
the ESP32 microcontroller, which acts as the brain of the drone. The user sends commands such as
take-off, landing, and movement using the transmitter. These commands are received by the receiver
and then sent to the ESP32 for processing. The ESP32 continuously collects data from different sensors
connected to it. The GPS module provides information about the drone’s position and location. The
MPU6050 sensor works as an IMU and measures acceleration and rotation of the drone, which helps
in maintaining balance and stability. The barometer measures air pressure and is used to estimate the
altitude of the drone. All this sensor data is sent to the ESP32 so that it can understand the current
condition of the drone. Based on the user commands and sensor inputs, the ESP32 calculates the
required control signals and sends them to four Electronic Speed Controllers (ESC1 to ESC4). Each
ESC controls one motor (M1 to M4 respectively). By changing the speed of these motors, the drone
can move up, down, forward, backward, and rotate in different directions. The system also includes an
nRF24L01 telemetry module, which provides wireless communication between the drone and the
ground station. This allows sending flight data such as sensor values and system status to the ground
station and receiving monitoring or control information when needed. Overall, this system combines
sensors, control processing, motor control, and wireless communication to ensure stable flight, proper
navigation, and real-time monitoring of the drone. The UAV platform developed in this work is a
quadcopter configuration consisting of four brushless DC motors mounted on a frame. The major
hardware components include a flight controller, inertial sensors, ESCs, power distribution unit,
battery, and a radio communication module. An IMU comprising a 3-axis accelerometer and a 3-axis


gyroscope is used to measure the UAVs orientation and angular rates. These sensor signals are
continuously fed to the flight controller, which processes the data to estimate roll, pitch, and yaw
angles. Based on the control algorithm output, PWM signals are generated to drive the ESCs, which
regulate motor speeds. Power is supplied using a Lithium Polymer (Li-Po) battery, selected based on
required flight time and thrust-to-weight ratio.

```
Figure 3: Block diagram of drone flight controller system
```
## 8. Experimental graphs


```
Figure 4: Accelerometer experimental result graph
```
```
Figure 5: Gyroscope experimental result graph
```
```
Figure 6: Kalman filter experimental result graph
```
## Figure 7: Complementary filter experimental result graph


Gyroscope-only attitude estimation suffers from cumulative drift over time while accelerometer-only
estimation is highly sensitive to noise and vibration during operation. The corresponding results are
illustrated in Fig.4 to 7, which visually compare the gyroscope, accelerometer, complementary filter,
and Kalman filter, and support the decision. Experimental evaluation showed that both the 1D Kalman
filter and the Complementary filter achieved comparable attitude estimation accuracy, maintaining
stability within ±0.5° while effectively mitigating gyroscope drift and accelerometer noise.

9. Control System Stability Analysis

The following analysis was conducted exclusively on a rate-mode PID control architecture, in which the
pilot commands angular velocity and the controller track these setpoints using gyroscope feedback. The
control loop operates at 250 Hz, providing sufficient bandwidth for stable flight control. The system
components include an ESP32 microcontroller, an MPU6050 sensor, 1400 KV motors, an F450 frame,
and a 2200 mAh battery. This configuration represents a high mechanical-gain system, with a thrust-to-
weight ratio of approximately. The system is primarily designed for payload lifting; however, it can also
be operated in idle or low-load conditions where no weight-lifting operation is performed. To verify the
stability of the control system mathematically, the following analysis derives the system transfer
functions and evaluates the closed-loop pole locations. This theoretical verification complements the
empirical flight testing.

9.1 PID Tuning Process

The PID controller parameters were determined through iterative flight testing ("black box tuning") to
achieve stable flight. The tuning process started with conservative values and progressively increased
gains until optimal response was achieved without oscillation.

```
Table 1: PID Tuning Iterations
Iteration Kp Ki Kd Outcome
Initial 0.035 0.00 0.00 Sluggish, drifting
Iteration 1 0.10 0.05 0.01 Underpowered response
Iteration 2 0.25 0.10 0.02 Improved, minor oscillation
Iteration 3 0.35 0.15 0.025 Good, slight overshoot
Final 0.40 0.20 0.03 Stable, no oscillation
```
The final values were selected as they provided the best balance between responsiveness and stability
for the high thrust-to-weight platform.

9.2 System Modeling

The quadcopter rotational dynamics are modeled based on Newton’s Euler equations, simplified for
single-axis rotation. The plant transfer function Gp(s) relates the controller output to the angular velocity.

9.2.1 Plant Block Components

The Plant block in the control diagram represents the complete physical system from controller output
to measured angular rate. It consists of three cascaded subsystems. The ESC and brushless DC motor


are modeled as a first-order lag system with time constant τm. This represents the delay between
commanded throttle and actual motor speed. The rotating propellers generate thrust and torque
proportional to the square of motor speed. For small perturbations around hover, this is linearized to a
torque gain Kτ. The rigid body rotation is governed by Newton’s Euler equation τ = Iω , where I is the
moment of inertia and ω is the angular rate. This relationship is an integrator (1/s) in the Laplace domain.
Combining these subsystems, the plant transfer function is:

where Kτ is the torque gain and τm is the motor time constant.

```
Table 2: System Parameters
Parameter Symbol Value Unit
Motor-to-center distance r 220 mm
Total aircraft mass m 880 g
Moment of inertia I 0.013 kg·m^2
Torque gain Kτ 85 deg/s^2 per unit
Motor time constant τm 30 ms
```
Substituting the parameters into Equation 1:

9.3 PID Controller

The rate controller Gc(s) implements a standard PID structure with a low-pass filter on the derivative

term to attenuate noise:

The derivative filter time constant Td is derived from the discrete low-pass filter coefficient α = 0.
and the sampling time Δt = 4 ms:

```
Table 3: Controller Parameters
```
```
Parameter Symbol Value Unit
Proportional gain
Integral gain
```
```
Kp
Ki
```
### 0.

### 0.

### -

```
s−^1
Derivative gain Kd 0.03 s
D-term filter constant Td 5.5 ms
Control loop frequency f 250 Hz
```

9.4 Stability Analysis

```
Figure 8: Rate Mode Control Loop Block Diagram. Signals: ωre f = rate setpoint (deg/s), e = error,
u=control output, ω = measured angular rate, Gc(s) = PID controller, Gp(s) = plant.
```
```
The system operates in a closed-loop configuration with unity negative feedback from the gyroscope.
The Closed-Loop Transfer Function T (s) is derived as:
```
```
Stability is determined by the poles of the closed-loop system, which are the roots of the characteristic
equation 1+Gc(s)Gp(s) = 0.
```
```
Table 4: Closed-Loop System Poles
```
```
Pole Location ζ ωn (rad/s)
1, 2 − 102. 6 ± 100. 4 j 0.71 143.
3 -9.5 - -
4 -0.5 - -
```
All poles reside in the left half of the s-plane, which confirms that the system is asymptotically stable.
The dominant complex poles exhibit a damping ratio of ζ = 0.71, which is near the optimal value of
0.707, indicating well-damped response.


```
Figure 9: S-plane pole-zero map showing all poles in the stable Left Half Plane.
```
9.5 Performance Evaluation

The transient response was evaluated by simulating a unit step input to the closed-loop system.

```
Table 5: Time Domain Performance Metrics
```
```
Metric Value Interpretation
Rise time (10-90%) 79 ms Fast response to inputs
Settling time (2%) 239 ms Quick convergence
Overshoot 0% No oscillation
Steady-state error 0% Zero tracking error
```
Figure 10: Unit step response of the rate control loop showing zero overshoot


```
The frequency domain stability margins were verified using Bode analysis:
```
```
Table 6: Stability Margins
```
```
Margin Value Requirement Status
Phase margin
Gain margin
```
### 81 ◦

```
> 20 dB
```
### > 45 ◦

```
> 6 dB
```
```
Satisfied
Satisfied
```
```
Figure 11: Bode plot showing Phase Margin of 81◦ and Gain Margin > 20 dB
```
Flight testing confirmed stable operation without oscillation, consistent with the calculated damping
ratio of ζ = 0.71. The observed "drift" behavior during hover is characteristic of Rate Mode (which
controls angular velocity, not attitude) and confirms correct operation of the rate loop. The analysis
validates that the implemented PID parameters (Kp = 0. 40 , Ki = 0. 20 , Kd = 0.03) provide a stable, robust,
and responsive control system for the F450 platform.

## 10. Angle Mode Stability Analysis

Upon verifying and implementing the rate controller, we confirmed that it is working exactly as
expected. Although some drift is observed, this behavior is expected because this mode relies solely on
gyroscope feedback and is purely dependent on user inputs. This drift can be compensated for in angle
mode. Angle mode is implemented using a cascaded control architecture, in which the outer loop
generates rate setpoints for the inner loop. In this mode, the pilot commands the desired attitude angles,
and the controller maintains these angles using accelerometer-derived attitude feedback.

10.1. Cascade Architecture

The cascade control structure is commonly used in flight control systems. The angle mode control
system consists of two cascaded loops.

1. Inner Loop (Rate): The previously verified rate controller with damping ratio ζ = 0. 71
2. Outer Loop (Angle): A PI controller that generates rate setpoints based on angle error


This hierarchical structure ensures that the fast inner loop stabilizes angular rate dynamics while the
slower outer loop tracks attitude references. Figure 6 illustrates the complete angle mode control
architecture.

Figure 12: Angle Mode Cascade Control with Complementary Filter. Signals: θre (^) f = angle setpoint
(deg), eθ = angle error, ωsp = rate setpoint, eω = rate error, u = control output, ω = angular rate, θˆ =
estimated angle from complementary filter.
10.2. Complementary Filter
The attitude feedback is obtained through a complementary filter, which combines gyroscope and ac-
celerometer data:
where α ≈ 0.04 provides optimal fusion - the gyroscope gives accurate short-term measurements while
the accelerometer corrects long-term drift.
10.3. Angle Controller Tuning
The tuning process focused on the outer loop PI gains (Kp,angle and Ki,angle). As our rate mode was
successful, we avoided interfering with the PID inputs for the rate loop to maintain inner loop stability.
The Angle gains were tuned iteratively using blackbox log analysis:


```
Table 7: Angle Mode Tuning Iterations
Iteration Kp,angle Ki,angle Outcome
1 3.0 0.0 Sluggish, steady-state trim error
2 4.0 0.0 Improved, but drift persists
3 5.0 0.0 Good response, trim error remains
4 5.0 0.5 Optimal - Fast leveling, zero trim error
```
The final selected values of Kp,angle = 5.0 and Ki,angle = 0.5 eliminated steady-state trim errors while
maintaining stable response.

```
Table 8: Final Angle Mode Parameters
Parameter Symbol Value
Angle Proportional Gain Kp,angle 5.
Angle Integral Gain Ki,angle 0.
Rate PID (Kp, Ki, Kd) – 0.40, 0.20, 0.
```
10.4. Transfer Function Derivation

In the cascade architecture, the outer angle loop uses the closed-loop rate system T (s) as its inner plant.
The angle plant Gp,θ (s) is the rate closed-loop followed by integration from rate to angle:

The angle controller is a PI controller:

The angle mode closed-loop transfer function Tθ (s) follows the same form as the rate loop:

10.5. Stability Analysis

Stability is verified by checking that all closed-loop poles are in the left half-plane. With the addition of
the integral term, the system order increases by one.


```
Table 9: Angle Mode Closed-Loop Poles (PI Controller)
Pole Location ζ ωn (rad/s)
1, 2 − 100. 5 ± 98. 3 j 0.72 140.
3, 4 − 6. 7 ± 2. 0 j 0.96 7.
5 − 0 .52 (real) – –
6 − 0 .10 (real) – –
```
All six poles are in the left half-plane, confirming asymptotic stability. The dominant poles (3, 4) have
ζ = 0.96, indicating overdamped response. The slow pole at − 0 .10 is introduced by the integral term
and provides zero steady-state error.

```
Figure 13: S-plane showing all poles in stable region (PI Controller).
```
```
Figure 14: Damping ratio analysis showing dominant poles with ζ = 0. 96
```

10.6. Performance Evaluation

```
Table 10: Angle Mode Step Response Performance
Metric Value Interpretation
Rise time (10-90%) 387 ms Smooth, controlled response
Settling time (2%) 641 ms Adequate for attitude hold
Overshoot 0% No oscillation
Steady-state error 0% Zero error (integral action)
```
```
Figure 15: Step response with zero overshoot and zero steady-state error.
```
```
Table 11: Angle Mode Stability Margins
Margin Value Requirement Status
Phase margin
Gain margin
```
### 81 ◦

```
33.8 dB
```
### > 45 ◦

```
> 6 dB
```
```
Satisfied
Satisfied
```

```
Figure 16: Bode plot showing stability margins (PI Controller).
```
The cascade controller with PI angle control is stable with ζ = 0.96 (overdamped). The addition of the
integral term (Ki,angle = 0.5) provides:

1. Zero steady-state error for step inputs
2. Elimination of trim offset caused by sensor bias or CG imbalance
3. Slow pole at s = − 0 .1 for gradual error correction

The stability margins exceed requirements (PM > 45, GM > 6 dB), confirming robust operation. The
angle mode successfully compensates for the drift observed in rate mode by maintaining the
commanded attitude using accelerometer feedback with integral action.

## C. Ground Station

The Ground Control Station (GCS) serves as the visualization interface for the pilot, displaying real-
time flight parameters such as GPS coordinates, altitude, and heading. To maintain portability and cross-
platform compatibility, proposed system is developed with custom web-based dashboard rather than
relying on heavy proprietary software.


```
Figure 17: Ground station
```
For the visualization software, Propose Project avoids creating a traditional desktop application often
requires complex driver installations. The system is built in such a way with a Single Page Application
using standard HTML/CSS and JavaScript. The modern browser standard allows the web application
(running in Chrome or Edge) to communicate directly with the ESP over the USB port. This makes the
system effective. The moment the ground hardware is connected, the dashboard begins visualizing data
without requiring a backend server.

3.1 Mapping

The interface integrates the Leaflet.js library to plot the drone's GPS coordinates on an open-source
map, visualizing the flight path in real-time.

3.2 Data Formatting

To ensure the data is human-readable for debugging, it is implemented as JavaScript Object Notation
(JSON) protocol. The Ground Receiver parses the binary radio packets and formats them into a
structured text string before sending it to the laptop.


The following image shows the final output of our drone project, which is a Drone Control Station or
Ground Station Interface. It provides a clear and simple way to monitor and control the drone in real
time. The main screen displays a map view, where the live position of the drone is shown using GPS
data. This helps the user easily track the drone’s location and movement during flight. On the right side,
important flight information such as battery level, altitude, speed, distance, and GPS status is displayed.
Telemetry data like latitude and longitude is also shown for accurate positioning. Overall, this interface
makes drone operation easy, safe, and user-friendly by combining live tracking, status monitoring, and
control options in one screen. The project will successfully develop a drone flight control and
monitoring system with a user-friendly ground station. Overall, the UAV achieves the intended
performance objectives, including stable hovering, responsive control, and acceptable flight endurance.
These results can help in providing a foundation for future enhancements such as autonomous
navigation and advanced control algorithms.

```
Figure 18: Web application front end
```
This Figure 8 shows the complete schematic diagram of the flight controller, illustrating electrical
connections between the ESP32 and peripherals such as sensors, ESCs, GPS, RF module, and power
components. It provides a logical representation of signal flow, power distribution, and interface
connections used in the design.

## IV. RESULTS AND DISCUSSION

The following image is the prototype for drone project, which is implemented and used for testing the
purpose. Experimental validation of the developed UAV is carried out through hover tests and
controlled flight experiments. The results demonstrate that the proposed hardware configuration and
control methodology provide stable flight performance during testing. During hover tests, the UAV
maintains stable roll and pitch angles with minimal oscillations, indicating effective attitude
stabilization. The tuned PID controllers ensure responsive control with acceptable tracking
performance. Yaw control is smooth and does not adversely affect the stability of other axes. Minor
deviations observed during real-time testing are mainly due to sensor noise, aerodynamic disturbances,
and actuator nonlinearities.


```
Figure 19: Prototype setup
```
```
The project will successfully develop a drone flight control and monitoring system with a user-
friendly ground station. Overall, the UAV achieves the intended performance objectives, including
stable hovering, responsive control, and acceptable flight endurance. These results can help in
providing a foundation for future enhancements such as autonomous navigation and advanced control
algorithms.
```
## V. CONCLUSION AND FUTURE WORK

The existing flight controllers are Closed source while suffer from limited devices connectivity and
high cost to procure for educational purpose, requiring multiple external modules for full functionality.
Although Some Open source platforms and frameworks for UAV control systems are available, they
often involve highly complex and extensively abstracted code structures, which can pose a significant
learning barrier for beginners and researchers. To address this issue, we aimed to develop ESP32-based
system that provides integrated Wi-Fi, sufficient storage, and multiple serial ports in a single, affordable
unit. This Project establishes an open-source foundation that can connects theory with real-world
implementation, enabling future upgrades like GPS navigation, altitude control, and autonomous flight.
This can help by providing valuable learning for students and researchers and in development of
advanced autonomous flight modes including waypoint navigation, return-to-home, and obstacle
avoidance using integrated GPS and sensor fusion algorithms. Future work may explore the
implementation of extended Kalman filtering or multi-sensor fusion techniques to improve attitude and
position estimation accuracy during aggressive maneuvers. Moreover, achieve performance evaluation
through field testing under diverse weather conditions, payload configurations, and flight scenarios to
establish reliability benchmarks and optimize control algorithms for research and educational UAV
applications.


## REFERENCES

```
[1] Waliszkiewicz, M., Wojtowicz, K., Rochala, Z., & Balestrieri, E. (2020). The Design and
Implementation of a Custom Platform for the Experimental Tuning of a Quadcopter Controller.
Sensors(Basel).30;20(7):1940.
```
```
[2] Mirtaba, M., Jeddi, M., Nikoofard, A. (2023). Design and implementation of a low- complexity
flight controller for a quadrotor UAV. Int. J. Dynam. Control 11, 689–700.
```
```
[3] Lasmadi, Cahyadi, A., Herdjunanto, S. & Hidayat, R. (2017). Inertial Navigation for Quadrotor
Using Kalman Filter with Drift Compensation. International Journal of Electrical and
Computer Engineering (IJECE). 7. 2596. 10.11591/ijece.v7i5.pp2596- 2604.
```
```
[4] Kadam, S., & Ruikar, S. (2024). Designing flight controller of quadcopter using STM32
microcontroller. International Journal of Innovative Research In Technology (IJIRT), 11(3),
1163-1168.
```
```
[5] Bolandi, H., Rezaei, M., Mohsenipour, R., Nemati, H. & Smailzadeh, S. (2013). Attitude
Control of a Quadrotor with Optimized PID Controller. Intelligent Control and Automation, 4,
335-342.
```
```
[6] Noordin, A., Basri, A., & Mohamed, Z. (2018). Sensor Fusion for Attitude Estimation and PID
Control of Quadrotor UAV. International Journal of Electrical and Electronic Engineering &
Telecommunications. 7. 183-189. 10.18178/ijeetc.7.4.183-189.
```
```
[7] Radoglou-Grammatikis, P., Sarigiannidis, P., Lagkas, T. & Moscholios, I. (2020). A compilation
of UAV applications for precision agriculture. Computer Networks 172:107148.
```
```
[8] Kangunde, V., Jamisola, R. & Theophilus, E. (2021). A review on drones controlled in real-
time. Int J Dyn Control 9(4):1832–1846.
```
```
[9] Poma, A., Sojo, A., Maza, I & Ollero, A. (2025). Ground Control Station for Multi- UAV
Systems in Infrastructure Inspection and Environmental Monitoring Applications. Journal of
Intelligent & Robotics Systems. 111:109
```
```
[10] Baynes, K., Collins, C., Fiterman, E., Brinda, G., Kohout, P., Christine, S., Zhang, T & Jacob,
B. (2003). The Performance and Energy consumption of Embedded Real-Time Operating
Systems. IEEE Transactions on computers, Vol.52, No.11
```

[11] Yang, T., Bu, K., Chen, G., Xie, X. & Xia, J. (2024). Fault-tolerant multi-rate sampled- data
control for quadrotor UAV. Nonlinear Dyn 112:12253-12267.

[12] Sahrir, N, H. & Basri, A. (2023). PSO-PID Controller for Quadcopter UAV: Index Performance
Comparison. Arabian Journal for Science and Engineering 48:15241- 15255.

[13] Zhou, L., Jin, H., Chen, P., Xiong, J., Li, C & Xiong, W. (2025). Actuator fault detection method
of quadrotor UAV based on dual channel inertial sensors. Zhou et al. Discover Applied Sciences
7:736.

[14] Sdoukou, E., Milidonis, A., Efstathiou, K & Voyiatzis, I. (2025). A survey of UAV hardware
selection. Sdoukou et al. Journal of Engineering and Applied Science. 72:88.

[15] Liu, M., Cai, Y., Zhang, L. & Wang, Y. (2021). Attitude Estimation Algorithm of Portable
Mobile Robot Based on Complementary Filter. Micromachines 2021, 12, 1373.

